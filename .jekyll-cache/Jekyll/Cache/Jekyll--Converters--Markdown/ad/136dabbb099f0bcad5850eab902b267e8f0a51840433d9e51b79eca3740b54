I"nO<blockquote>
  <p>JPAì—ì„œ QueryDslë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ì„œ ì•Œì•„ë³´ì. QueryDSLì€ ì¿¼ë¦¬ domain specific languageë¡œ ë„ë©”ì¸ì— ë§ê²Œ ì¿¼ë¦¬ë¥¼ í”„ë¡œê·¸ë§ í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì´ë‹¤.
<!-- more --></p>
</blockquote>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">List</span><span class="o">&lt;</span><span class="nc">Person</span><span class="o">&gt;</span> <span class="n">persons</span> <span class="o">=</span> <span class="n">queryFactory</span><span class="o">.</span><span class="na">selectFrom</span><span class="o">(</span><span class="n">person</span><span class="o">)</span>
  <span class="o">.</span><span class="na">where</span><span class="o">(</span>
    <span class="n">person</span><span class="o">.</span><span class="na">firstName</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="s">"John"</span><span class="o">),</span>
    <span class="n">person</span><span class="o">.</span><span class="na">lastName</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="s">"Doe"</span><span class="o">))</span>
  <span class="o">.</span><span class="na">fetch</span><span class="o">();</span>
</code></pre></div></div>

<p>ì´ëŸ° ëŠë‚Œ!ğŸ˜€</p>

<h2 id="ì˜ˆì œ-ì½”ë“œ">ì˜ˆì œ ì½”ë“œ</h2>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="nd">@Table</span>
<span class="nd">@Data</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Account</span> <span class="o">{</span>

    <span class="nd">@Id</span>
    <span class="nd">@GeneratedValue</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">firstName</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">lastName</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">AccountRepository</span> <span class="kd">extends</span> <span class="nc">JpaRepository</span><span class="o">&lt;</span><span class="nc">Account</span><span class="o">,</span> <span class="nc">Long</span><span class="o">&gt;</span> <span class="o">{</span>
<span class="o">}</span>
</code></pre></div></div>

<p>idì™€ titleë§Œ ìˆëŠ” Accountì—”í‹°í‹°ë¥¼ ì •ì˜í•˜ê³ , ê¸°ë³¸ì ìœ¼ë¡œ JpaReposiotryë¥¼ ìƒì†ë°›ëŠ” ë ˆí¬ì§€í† ë¦¬ë¥¼ ë§Œë“ ë‹¤.</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nt">&lt;dependency&gt;</span>
        <span class="nt">&lt;groupId&gt;</span>com.querydsl<span class="nt">&lt;/groupId&gt;</span>
        <span class="nt">&lt;artifactId&gt;</span>querydsl-apt<span class="nt">&lt;/artifactId&gt;</span>
        <span class="nt">&lt;scope&gt;</span>provided<span class="nt">&lt;/scope&gt;</span>
    <span class="nt">&lt;/dependency&gt;</span>

    <span class="nt">&lt;dependency&gt;</span>
        <span class="nt">&lt;groupId&gt;</span>com.querydsl<span class="nt">&lt;/groupId&gt;</span>
        <span class="nt">&lt;artifactId&gt;</span>querydsl-jpa<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;/dependency&gt;</span>
</code></pre></div></div>

<p>ë‹¤ìŒê³¼ ê°™ì´ ì˜ì¡´ì„±ì„ ì£¼ì…í•œë‹¤.</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>...
        <span class="nt">&lt;plugins&gt;</span>
            ...
            <span class="nt">&lt;plugin&gt;</span>
                <span class="nt">&lt;groupId&gt;</span>com.mysema.maven<span class="nt">&lt;/groupId&gt;</span>
                <span class="nt">&lt;artifactId&gt;</span>apt-maven-plugin<span class="nt">&lt;/artifactId&gt;</span>
                <span class="nt">&lt;version&gt;</span>1.1.3<span class="nt">&lt;/version&gt;</span>
                <span class="nt">&lt;executions&gt;</span>
                    <span class="nt">&lt;execution&gt;</span>
                        <span class="nt">&lt;goals&gt;</span>
                            <span class="nt">&lt;goal&gt;</span>process<span class="nt">&lt;/goal&gt;</span>
                        <span class="nt">&lt;/goals&gt;</span>
                        <span class="nt">&lt;configuration&gt;</span>
                            <span class="nt">&lt;outputDirectory&gt;</span>target/generated-sources/java<span class="nt">&lt;/outputDirectory&gt;</span>
                            <span class="nt">&lt;processor&gt;</span>com.querydsl.apt.jpa.JPAAnnotationProcessor<span class="nt">&lt;/processor&gt;</span>
                        <span class="nt">&lt;/configuration&gt;</span>
                    <span class="nt">&lt;/execution&gt;</span>
                <span class="nt">&lt;/executions&gt;</span>
            <span class="nt">&lt;/plugin&gt;</span>
        <span class="nt">&lt;/plugins&gt;</span>
</code></pre></div></div>

<p>ë‹¤ìŒê³¼ ê°™ì€ í”ŒëŸ¬ê·¸ì¸ì„ ì£¼ì…í•œë‹¤. í•´ë‹¹ í”ŒëŸ¬ê·¸ì¸ì€ compileí•  ë•Œ, Postì—”í‹°í‹°ë¥¼ í†µí•´ì„œ Queryë¥¼ ë§Œë“¤ ìˆ˜ ìˆëŠ” QAccountë¼ëŠ” í´ë˜ìŠ¤ë¥¼ ìë™ìœ¼ë¡œ ìƒì„±í•´ ì£¼ëŠ” í”ŒëŸ¬ê·¸ì¸ì´ë‹¤. ìœ„ë¥¼ ë³´ë©´, <code class="language-plaintext highlighter-rouge">outputDirectory</code>ê°€ QAccount ë¼ëŠ” í´ë˜ìŠ¤ë“¤ì´ ë§Œë“¤ì–´ì§€ëŠ” ìœ„ì¹˜ì´ë‹¤. ë˜í•œ ì‚¬ìš©í•˜ëŠ” í”„ë¡œì„¸ì„œëŠ” <code class="language-plaintext highlighter-rouge">JPAAnnotationProcessor</code> ë¥¼ ì‚¬ìš©í•œë‹¤.</p>

<p>ì´ë ‡ê²Œ ì¶”ê°€í•˜ê³ , console ì°½ì— ë‹¤ìŒê³¼ ê°™ì´ ì…ë ¥í•œë‹¤.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ mvn clean &amp;&amp; compile
</code></pre></div></div>

<p>cleanì€ target ë””ë ‰í† ë¦¬ë¥¼ ë¹„ìš°ëŠ” ê²ƒì´ê³ , compileì„ í†µí•´ì„œ ìš°ë¦¬ê°€ ì›í•˜ëŠ” QPostë¼ëŠ” í´ë˜ìŠ¤ë¥¼ ìƒì„±í•œë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/**
 * QAccount is a Querydsl query type for Account
 */</span>
<span class="nd">@Generated</span><span class="o">(</span><span class="s">"com.querydsl.codegen.EntitySerializer"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">QAccount</span> <span class="kd">extends</span> <span class="nc">EntityPathBase</span><span class="o">&lt;</span><span class="nc">Account</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">760879443L</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">QAccount</span> <span class="n">account</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">QAccount</span><span class="o">(</span><span class="s">"account"</span><span class="o">);</span>

    <span class="kd">public</span> <span class="kd">final</span> <span class="nc">StringPath</span> <span class="n">firstName</span> <span class="o">=</span> <span class="n">createString</span><span class="o">(</span><span class="s">"firstName"</span><span class="o">);</span>

    <span class="kd">public</span> <span class="kd">final</span> <span class="nc">NumberPath</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">&gt;</span> <span class="n">id</span> <span class="o">=</span> <span class="n">createNumber</span><span class="o">(</span><span class="s">"id"</span><span class="o">,</span> <span class="nc">Long</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

    <span class="kd">public</span> <span class="kd">final</span> <span class="nc">StringPath</span> <span class="n">lastName</span> <span class="o">=</span> <span class="n">createString</span><span class="o">(</span><span class="s">"lastName"</span><span class="o">);</span>

    <span class="kd">public</span> <span class="nf">QAccount</span><span class="o">(</span><span class="nc">String</span> <span class="n">variable</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">(</span><span class="nc">Account</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">forVariable</span><span class="o">(</span><span class="n">variable</span><span class="o">));</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nf">QAccount</span><span class="o">(</span><span class="nc">Path</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="nc">Account</span><span class="o">&gt;</span> <span class="n">path</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">(</span><span class="n">path</span><span class="o">.</span><span class="na">getType</span><span class="o">(),</span> <span class="n">path</span><span class="o">.</span><span class="na">getMetadata</span><span class="o">());</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nf">QAccount</span><span class="o">(</span><span class="nc">PathMetadata</span> <span class="n">metadata</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">(</span><span class="nc">Account</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">metadata</span><span class="o">);</span>
    <span class="o">}</span>

<span class="o">}</span>
</code></pre></div></div>

<p>QueryDslë¥¼ ì‚¬ìš©í•˜ëŠ” ì´ìœ ê°€ ì—¬ëŸ¬ê°œ ìˆê² ì§€ë§Œ, ê²°êµ­ ì¡°ê±´ì ˆì—ì„œ typeSafeí•˜ê²Œ ë¹„êµí•˜ëŠ” ë¬¸ì¥ì„ ë§Œë“¤ ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ì‚¬ìš©í•œë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">AccountRepository</span> <span class="kd">extends</span> <span class="nc">JpaRepository</span><span class="o">&lt;</span><span class="nc">Account</span><span class="o">,</span> <span class="nc">Long</span><span class="o">&gt;,</span> <span class="nc">QuerydslPredicateExecutor</span><span class="o">&lt;</span><span class="nc">Account</span><span class="o">&gt;</span> <span class="o">{</span>
<span class="o">}</span>
</code></pre></div></div>

<p>ë‹¤ìŒê³¼ ê°™ì´ <code class="language-plaintext highlighter-rouge">QueryDslPredicateExecutor&lt;T&gt;</code> ë¥¼ ì¶”ê°€í•¨ìœ¼ë¡œì¨ Predicate ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">QuerydslPredicateExecutor</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="cm">/**
     * Returns a single entity matching the given {@link Predicate} or {@link Optional#empty()} if none was found.
     *
     * @param predicate must not be {@literal null}.
     * @return a single entity matching the given {@link Predicate} or {@link Optional#empty()} if none was found.
     * @throws org.springframework.dao.IncorrectResultSizeDataAccessException if the predicate yields more than one
     *           result.
     */</span>
    <span class="nc">Optional</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="nf">findOne</span><span class="o">(</span><span class="nc">Predicate</span> <span class="n">predicate</span><span class="o">);</span>

    <span class="cm">/**
     * Returns all entities matching the given {@link Predicate}. In case no match could be found an empty
     * {@link Iterable} is returned.
     *
     * @param predicate must not be {@literal null}.
     * @return all entities matching the given {@link Predicate}.
     */</span>
    <span class="nc">Iterable</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="nf">findAll</span><span class="o">(</span><span class="nc">Predicate</span> <span class="n">predicate</span><span class="o">);</span>

    <span class="cm">/**
     * Returns all entities matching the given {@link Predicate} applying the given {@link Sort}. In case no match could
     * be found an empty {@link Iterable} is returned.
     *
     * @param predicate must not be {@literal null}.
     * @param sort the {@link Sort} specification to sort the results by, may be {@link Sort#empty()}, must not be
     *          {@literal null}.
     * @return all entities matching the given {@link Predicate}.
     * @since 1.10
     */</span>
    <span class="nc">Iterable</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="nf">findAll</span><span class="o">(</span><span class="nc">Predicate</span> <span class="n">predicate</span><span class="o">,</span> <span class="nc">Sort</span> <span class="n">sort</span><span class="o">);</span>

    <span class="cm">/**
     * Returns all entities matching the given {@link Predicate} applying the given {@link OrderSpecifier}s. In case no
     * match could be found an empty {@link Iterable} is returned.
     *
     * @param predicate must not be {@literal null}.
     * @param orders the {@link OrderSpecifier}s to sort the results by.
     * @return all entities matching the given {@link Predicate} applying the given {@link OrderSpecifier}s.
     */</span>
    <span class="nc">Iterable</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="nf">findAll</span><span class="o">(</span><span class="nc">Predicate</span> <span class="n">predicate</span><span class="o">,</span> <span class="nc">OrderSpecifier</span><span class="o">&lt;?&gt;...</span> <span class="n">orders</span><span class="o">);</span>

    <span class="cm">/**
     * Returns all entities ordered by the given {@link OrderSpecifier}s.
     *
     * @param orders the {@link OrderSpecifier}s to sort the results by.
     * @return all entities ordered by the given {@link OrderSpecifier}s.
     */</span>
    <span class="nc">Iterable</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="nf">findAll</span><span class="o">(</span><span class="nc">OrderSpecifier</span><span class="o">&lt;?&gt;...</span> <span class="n">orders</span><span class="o">);</span>

    <span class="cm">/**
     * Returns a {@link Page} of entities matching the given {@link Predicate}. In case no match could be found, an empty
     * {@link Page} is returned.
     *
     * @param predicate must not be {@literal null}.
     * @param pageable may be {@link Pageable#unpaged()}, must not be {@literal null}.
     * @return a {@link Page} of entities matching the given {@link Predicate}.
     */</span>
    <span class="nc">Page</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="nf">findAll</span><span class="o">(</span><span class="nc">Predicate</span> <span class="n">predicate</span><span class="o">,</span> <span class="nc">Pageable</span> <span class="n">pageable</span><span class="o">);</span>

    <span class="cm">/**
     * Returns the number of instances matching the given {@link Predicate}.
     *
     * @param predicate the {@link Predicate} to count instances for, must not be {@literal null}.
     * @return the number of instances matching the {@link Predicate}.
     */</span>
    <span class="kt">long</span> <span class="nf">count</span><span class="o">(</span><span class="nc">Predicate</span> <span class="n">predicate</span><span class="o">);</span>

    <span class="cm">/**
     * Checks whether the data store contains elements that match the given {@link Predicate}.
     *
     * @param predicate the {@link Predicate} to use for the existence check, must not be {@literal null}.
     * @return {@literal true} if the data store contains elements that match the given {@link Predicate}.
     */</span>
    <span class="kt">boolean</span> <span class="nf">exists</span><span class="o">(</span><span class="nc">Predicate</span> <span class="n">predicate</span><span class="o">);</span>
<span class="o">}</span>

</code></pre></div></div>

<p>í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ë¥¼ ì‘ì„±í•´ë³´ì.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@DataJpaTest</span>
<span class="nd">@RunWith</span><span class="o">(</span><span class="nc">SpringRunner</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">AccountRepositoryTest</span> <span class="o">{</span>

    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="nc">AccountRepository</span> <span class="n">accountRepository</span><span class="o">;</span>

    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">crud</span><span class="o">()</span> <span class="o">{</span>

        <span class="nc">Account</span> <span class="n">account</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Account</span><span class="o">();</span>
        <span class="n">account</span><span class="o">.</span><span class="na">setFirstName</span><span class="o">(</span><span class="s">"andrew"</span><span class="o">);</span>
        <span class="n">account</span><span class="o">.</span><span class="na">setLastName</span><span class="o">(</span><span class="s">"han"</span><span class="o">);</span>
        <span class="n">accountRepository</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">account</span><span class="o">);</span>

        <span class="nc">QAccount</span> <span class="n">qAccount</span> <span class="o">=</span> <span class="nc">QAccount</span><span class="o">.</span><span class="na">account</span><span class="o">;</span>
        <span class="nc">Optional</span><span class="o">&lt;</span><span class="nc">Account</span><span class="o">&gt;</span> <span class="n">andrew</span> <span class="o">=</span> <span class="n">accountRepository</span><span class="o">.</span><span class="na">findOne</span><span class="o">(</span><span class="n">qAccount</span><span class="o">.</span><span class="na">firstName</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="s">"andrew"</span><span class="o">));</span>

        <span class="nc">Account</span> <span class="n">result</span> <span class="o">=</span> <span class="n">andrew</span><span class="o">.</span><span class="na">get</span><span class="o">();</span>
        <span class="nc">Assert</span><span class="o">.</span><span class="na">assertEquals</span><span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">getFirstName</span><span class="o">(),</span> <span class="s">"andrew"</span><span class="o">);</span>


    <span class="o">}</span>
<span class="o">}</span>

</code></pre></div></div>

<p>Account í•˜ë‚˜ë¥¼ ë§Œë“¤ì–´ì„œ ì €ì¥í•˜ê³ , QAccountí˜•ì˜ í•„ë“œ qAccountë¥¼ ë§Œë“¤ì–´ ë†“ê³ , ì•„ë˜ì™€ ê°™ì´ typeSafeí•˜ê²Œ ì ‘ê·¼í•´ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ì˜ˆì œì—ì„œëŠ” accountì˜ firstNameì´ â€œandrewâ€ì¸ ì¡°ê±´ì ˆì„ ì°¾ëŠ” ë©”ì„œë“œ ì´ë‹¤.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>...// ìƒëµ
Hibernate:
    select
        account0_.id as id1_0_,
        account0_.first_name as first_na2_0_,
        account0_.last_name as last_nam3_0_
    from
        account account0_
    where
        account0_.first_name=?

</code></pre></div></div>

<p>ì¿¼ë¦¬ë­”ì„ ë³´ë©´, where ì¡°ê±´ì ˆì˜ first_nameìœ¼ë¡œ ì°¾ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p>
:ET